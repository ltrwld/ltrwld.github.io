<!DOCTYPE html>
<html>
  <head>
    <title>12 AR Wall - CERQ</title>
    <meta name="description" content="AR Wall - CERQ">
	 <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
	 <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
	 
	  <script>
        //Multi Markers WebAR-AR.js and Aframe - Playing the Archive - Connected Environment CASA-UCL

//Global Variable
var markersURLArray=[];
var markersNameArray=[];

AFRAME.registerComponent('markers_start',{
	init:function(){
		console.log('Add markers to the scene');

		var sceneEl = document.querySelector('a-scene');
		
		//list of the markers
		for(var i=1; i<18; i++)
		{
			var url="resources/markers/pattern-Individual_Blocks-"+i+".patt";
			markersURLArray.push(url);
			markersNameArray.push('Marker_'+i);
			//console.log(url);
		}

		for(var k=0; k<17; k++)
		{
			var markerEl = document.createElement('a-marker');
			const number = k;
		
			markerEl.setAttribute('type','pattern');
			markerEl.setAttribute('url',markersURLArray[k]);
			markerEl.setAttribute('id',markersNameArray[k]);
			markerEl.setAttribute('class','marker');
			
			markerEl.setAttribute('registerevents','');
			sceneEl.appendChild(markerEl);

			//Adding text to each marker
			var img = document.createElement('a-image');
			
			img.setAttribute('src','#' + markersNameArray[k]);
			img.setAttribute('link','href: https://ltrwld.github.io/redirect.html?link=' + markersNameArray[k]);
			img.setAttribute('id',markersNameArray[k]);
			img.setAttribute('scale','3 3 3'); 
			img.setAttribute('class','image clickable');
			img.object3D.position.set(0, 0.5, 0);
			img.object3D.rotation.set(-90, 0, 0);

			markerEl.appendChild(img);
		}
	}
});


//Detect marker found and lost
AFRAME.registerComponent('registerevents', {
		init: function () {
			const marker = this.el;

			marker.addEventListener("markerFound", ()=> {
				var markerId = marker.id;
				console.log('Marker Found: ', markerId);
			});

			marker.addEventListener("markerLost",() =>{
				var markerId = marker.id;
				console.log('Marker Lost: ', markerId);
			});
		},
	});
      </script>
	</head>

	<body style="width: 100vw !important;
	height: 100vh !important; margin : 0px; overflow: hidden;">

		<a-scene cursor='rayOrigin: mouse; fuse: true; fuseTimeout: 0;'
				 raycaster="objects: .clickable"
				 markers_start
				 vr-mode-ui="enabled: false" 
				 color-space="sRGB" 
				 renderer="gammaOutput: true" 
				 embedded arjs='debugUIEnabled: false; 
				 				sourceType: webcam; 
								patternRatio: 0.85; 
								trackingMethod: best;' 
				 embedded
				 gesture-detector>
			<a-assets>
				<img id="Marker_1" src="content/block-1.png">
				<img id="Marker_2" src="content/block-2.png">
				<img id="Marker_3" src="https://picsum.photos/200/500">
				<img id="Marker_4" src="content/block-4.png">
				<img id="Marker_5" src="content/block-5.png">
				<img id="Marker_6" src="https://picsum.photos/200">
				<img id="Marker_7" src="https://picsum.photos/200">
				<img id="Marker_8" src="https://picsum.photos/200">
				<img id="Marker_9" src="https://picsum.photos/200">
				<img id="Marker_10" src="https://picsum.photos/200">
				<img id="Marker_11" src="https://picsum.photos/200">
				<img id="Marker_12" src="https://picsum.photos/200">
				<img id="Marker_13" src="https://picsum.photos/200">
				<img id="Marker_14" src="https://picsum.photos/200">
				<img id="Marker_15" src="https://picsum.photos/200">
				<img id="Marker_16" src="https://picsum.photos/200">
				<img id="Marker_17" src="https://picsum.photos/200">
				<img id="Marker_18" src="https://picsum.photos/200">
			</a-assets>
    		<a-entity id='userCamera' camera>
				
    		</a-entity>
		</a-scene>

	</body>
</html>
